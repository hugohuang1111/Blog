---
title: 泊车历史轨迹显示方案
date: 2025-06-20
author: hugo
icon: book
tag:
    - parking
    - hmi
---

## 背景

最近在做 3D 的记忆泊车, 其中就遇到一个问题, 自车往前走时，会在后面产生一条道路线, 也叫自车的历史轨迹.
此时的历史轨迹是由传感器定时发送到 HMI , 帧率为 10 Hz.

## 分析

1. 历史轨迹是自车的轨迹, 所以历史轨迹必然是要从自车的后轮下发出.
2. 历史轨迹是以 10 Hz 的频率发送的, 所以历史轨迹必然是跳动增长的.
3. 同时也因为数据是 10 Hz 的频率, 所以自车必然会做平滑.

## 历程

### 第一次, 自车一顿一顿的
好, 那我给自车加上平滑

### 第二次, 历史轨迹与自车后轮的间隔时大时小
行，那我把历史轨迹放到自车结点下, 当自车平滑, 历史轨迹也跟着平滑了，这样历史轨迹就一定是从后轮发出了

### 第三次, 历史轨迹在自车转弯时晃动厉害
唉, 这是历史轨迹的数据因为帧率, 所以数据本身必然是突增的. 在转弯时, 历史轨迹的突变就很容易表现出来。

经过各种办法, 我做了如下修改：

* 把历史轨迹延伸到自车的坐标点下.
* 根据自车平滑的位置与历史轨迹, 计算UV上的一个偏移, 然后偏移之前的道路全部透时, 这样就可以历史轨迹就可以稳定地从自车后轮后显示出来.

---
转自: [HH](http://www.hugohuang.xyz/)

